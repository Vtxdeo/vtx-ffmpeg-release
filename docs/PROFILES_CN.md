# VTX FFmpeg 预设场景清单

本文档详细列出了 VTX FFmpeg Release 仓库中所有构建预设（Profiles）的设计目的、适用场景及技术边界。此清单旨在为开发人员和自动化工具提供选择依据，确保在不同硬件和业务需求下选择最优的二进制版本。

## 1. 基础通用层 (General Purpose)
此类预设以“体积”为核心维度，适用于对功能边界要求不明确的通用场景。

| 预设名称 | 目标体积 | 核心能力 | 典型应用场景 |
| :--- | :--- | :--- | :--- |
| **nano** | ~1 MB | **元数据提取**。<br>仅含 `ffprobe`，支持常见格式解封装。无任何编解码能力。 | 文件上传校验、时长检测、媒体库扫描初期。 |
| **micro** | ~5 MB | **缩略图生成**。<br>含 H.264/HEVC 基础解码 + MJPEG/PNG 编码。支持缩放 (scale)。 | 树莓派 Zero、低端 NAS 的封面生成服务。 |
| **mini** | ~15 MB | **通用媒体处理**。<br>包含常见滤镜、常见音频编码。平衡体积与功能。 | 个人网盘、轻量级转码任务、家庭实验室。 |
| **full** | >50 MB | **全功能集**。<br>启用所有编译选项、所有滤镜及非自由协议。 | 桌面端应用、高性能服务器、开发环境。 |

## 2. 输入与接入层 (Ingest & IO)
此类预设专注于媒体流的“获取”与“识别”，通常运行在网络边缘或算力受限的网关设备上。

| 预设名称 | 核心能力 | 关键组件 | 典型应用场景 |
| :--- | :--- | :--- | :--- |
| **stream** | **流媒体转发**。<br>专注于协议支持，极低的 CPU 占用。 | 协议: `rtmp`, `rtsp`, `hls`<br>滤镜: `copy` 模式优化 | 直播推流盒子、安防摄像头接入、无人机图传转发。 |
| **indexer** | **全能索引**。<br>极致的解封装兼容性，牺牲编码能力换取读取能力。 | 解码: `vp9`, `av1`, `webm`, `wmv`<br>滤镜: `select`, `tile` (雪碧图) | 媒体资产管理系统 (MAM) 的扫描端、云存储文件分析。 |
| **audio** | **纯音频处理**。<br>剥离所有视频组件，专注于音频转码与分析。 | 编码: `aac`, `flac`, `opus`, `mp3`<br>滤镜: `silencedetect`, `volume` | 在线电台、播客托管平台、听书应用后端。 |

## 3. 处理流水线层 (Processing Pipeline)
此类预设用于核心计算节点，根据任务类型（IO密集型 vs CPU密集型）进行明确分工。

| 预设名称 | 核心能力 | 关键组件 | 典型应用场景 |
| :--- | :--- | :--- | :--- |
| **remux** | **容器转换**。<br>不涉及编解码，仅进行封装格式的变更，速度极快。 | 封装: `mp4`, `mkv`, `mov`, `ts`<br>特性: 码流过滤 (BSF) | 视频网站上传预处理 (如 MKV 转 MP4)、无损剪辑。 |
| **transcode** | **全量转码**。<br>使用 FFmpeg 原生编解码器进行软解和软编。 | 编码: `mpeg4`, `prores`, `aac`<br>兼容: 无依赖静态链接 | 独立的转码集群、格式工厂服务、旧视频修复。 |
| **animator** | **动图生成**。<br>专注于高画质 GIF/WebP/APNG 的生成。 | 滤镜: `palettegen`, `paletteuse`<br>编码: `gif`, `apng` | 表情包制作工具、社交媒体分享片段生成。 |

## 4. 交付与归档层 (Delivery & Storage)
此类预设关注媒体文件的“最终形态”，无论是面向 Web 分发还是长期冷存储。

| 预设名称 | 核心能力 | 关键组件 | 典型应用场景 |
| :--- | :--- | :--- | :--- |
| **vod** | **切片分发**。<br>生成适用于 H5 播放器的流媒体切片文件。 | 封装: `hls`, `dash`, `segment`<br>特性: 多码率清单生成 | 自建视频托管、在线教育平台点播服务。 |
| **archive** | **无损归档**。<br>确保视音频数据在数十年后仍可由开源软件读取。 | 编码: `ffv1` (视频), `flac` (音频)<br>封装: `mkv`, `nut` | 图书馆/博物馆数字资产库、原始素材冷备份。 |

## 5. 特殊用途层 (Specialized)
针对特定硬件限制或运维调试需求的特殊版本。

| 预设名称 | 核心能力 | 关键组件 | 典型应用场景 |
| :--- | :--- | :--- | :--- |
| **debug** | **故障分析**。<br>包含详细的日志输出和可视化分析工具。 | 滤镜: `trace_headers`, `datascope`, `vectorscope` | 生产环境故障排查、编码参数调优分析。 |
| **legacy** | **老旧兼容**。<br>禁用高级指令集，确保在低端架构下的稳定性。 | 禁用: `asm`, `pthreads` (部分)<br>架构: MIPS, ARMv5 | 运行在十年前的路由器、老式机顶盒或嵌入式工控机。 |

---

## 预设选择决策树 (Decision Guide)

当集成 VTX FFmpeg 时，请参考以下逻辑选择预设：

1.  **需要处理视频画面吗？**
    * 否 (仅音频) -> `audio`
    * 否 (仅元数据) -> `nano`
    * 是 -> *跳转步骤 2*

2.  **需要修改视频编码 (转码) 吗？**
    * 否 (仅换容器) -> `remux`
    * 否 (仅推流/复制) -> `stream`
    * 是 -> *跳转步骤 3*

3.  **目标是网页播放还是下载？**
    * 网页流式播放 -> `vod`
    * 动图分享 -> `animator`
    * 存档保存 -> `archive`
    * 通用/未知 -> *跳转步骤 4*

4.  **硬件环境如何？**
    * 极度受限 (IoT/Router) -> `micro` (基础) 或 `legacy` (兼容)
    * 普通 (NAS/PC) -> `mini` (平衡)
    * 专用计算节点 -> `transcode` (软解) 或 `full` (完整)
    * 调试问题 -> `debug`